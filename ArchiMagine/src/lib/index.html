<html>
	<head>
        <script type="text/javascript" src="https://raw.githubusercontent.com/nfigay/vis/master/ArchiMagine/src/js/Jsonix-all.js"></script> 
        <script type="text/javascript" src="https://raw.githubusercontent.com/nfigay/vis/master/ArchiMagine/src/js/P0.js"></script> 
		<script>
			Jsonix.Request.PROXY = 'servlet/proxy?url=';
		</script> 
	</head>
	<body>
		<p>
			The map "<span id="title"></span>" contains the following layers: <span id="layers"></span>.
		</p>
		

		<script type="text/javascript">

			// Utility function
			var setValue = function(id, value) {
				var element = document.getElementById(id);
				element.innerHTML = value;
			};
            
            let header = new Headers({'Access-Control-Allow-Origin':'','Content-Type': 'multipart/form-data'});

			//// Jsonix usage

			// Create Jsonix context
			var context = new Jsonix.Context([ P0 ]);

			// Create unmarshaller
			var unmarshaller = context.createUnmarshaller();

			// Unmarshal the XML file from URL
			unmarshaller.unmarshalURL( 'http://www2.demis.nl/WMS/wms.ashx?wms=WorldMap&REQUEST=GetCapabilities&VERSION=1.3.0',
				function(element) {

					// Unmarshalling is complete

					// Now we can worked with the unmarshalled object
					var capabilities = element.value;

					setValue('title', capabilities.capability.layer.title);
					
					var layerNames = [];
					for (var index = 0; index < capabilities.capability.layer.layer.length; index++)
					{
						layerNames.push(capabilities.capability.layer.layer[index].name);
					}
					setValue('layers', layerNames.join(', '));
				});
		</script>
	</body>
</html>